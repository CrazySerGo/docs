"use strict";(self.webpackChunkdocs_oasis_dev=self.webpackChunkdocs_oasis_dev||[]).push([[1328],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=r.createContext({}),u=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=u(n),m=i,h=d["".concat(l,".").concat(m)]||d[m]||c[m]||o;return n?r.createElement(h,a(a({ref:t},p),{},{components:n})):r.createElement(h,a({ref:t},p))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var u=2;u<o;u++)a[u]=n[u];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},628:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return c}});var r=n(7462),i=n(3366),o=(n(7294),n(3905)),a=["components"],s={},l="Reproducibility",u={unversionedId:"runtime/reproducibility",id:"runtime/reproducibility",title:"Reproducibility",description:"If you wish to build paratime binaries yourself, you can use the",source:"@site/external/oasis-sdk/docs/runtime/reproducibility.md",sourceDirName:"runtime",slug:"/runtime/reproducibility",permalink:"/oasis-sdk/runtime/reproducibility",tags:[],version:"current",lastUpdatedAt:1646642658,formattedLastUpdatedAt:"3/7/2022",frontMatter:{},sidebar:"oasisSdk",previous:{title:"Modules",permalink:"/oasis-sdk/runtime/modules"}},p={},c=[{value:"Environment Setup",id:"environment-setup",level:2},{value:"Running the Image",id:"running-the-image",level:2},{value:"Building",id:"building",level:2}],d={toc:c};function m(e){var t=e.components,n=(0,i.Z)(e,a);return(0,o.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"reproducibility"},"Reproducibility"),(0,o.kt)("p",null,"If you wish to build paratime binaries yourself, you can use the\nenvironment provided as part of the SDK. This way you can also verify\nthat the binaries match the ones running on the network."),(0,o.kt)("p",null,"The steps below show how to build the test runtimes provided in the\n",(0,o.kt)("inlineCode",{parentName:"p"},"oasis-sdk")," sources; steps for other paratimes should be similar."),(0,o.kt)("h2",{id:"environment-setup"},"Environment Setup"),(0,o.kt)("p",null,"The build environment is provided as a Docker image containing all the\nnecessary tools. Refer to your system's documentation for pointers on\ninstalling software."),(0,o.kt)("p",null,"The runtime sources need to be mounted into the container so prepare a\ndirectory first, such as:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/oasisprotocol/oasis-sdk.git\n")),(0,o.kt)("h2",{id:"running-the-image"},"Running the Image"),(0,o.kt)("p",null,"The images are available in the ",(0,o.kt)("inlineCode",{parentName:"p"},"oasisprotocol/runtime-builder"),"\nrepository on Docker Hub and are tagged with the same version numbers as\nreleases of the SDK. To pull the image and run a container with it, run\nthe following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -t -i -v /home/user/oasis-sdk:/src oasisprotocol/runtime-builder:main /bin/bash\n")),(0,o.kt)("p",null,"where:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"/home/user/oasis-sdk")," is the absolute path to the directory\ncontaining the SDK sources (or other paratimes - you likely do not need\nto download the SDK separately if you're building other paratimes), and"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"main")," is a release of the SDK - the documentation of the paratime\nyou're trying to build should mention the version required.")),(0,o.kt)("p",null,"This gives you a root shell in the container. Rust and Cargo are\ninstalled in ",(0,o.kt)("inlineCode",{parentName:"p"},"/cargo"),", Go in ",(0,o.kt)("inlineCode",{parentName:"p"},"/go"),", and the sources to your paratime are\navailable in ",(0,o.kt)("inlineCode",{parentName:"p"},"/src"),"."),(0,o.kt)("h2",{id:"building"},"Building"),(0,o.kt)("p",null,"Follow the normal build procedure for your paratime. For the testing\nruntimes in the SDK, e.g.:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cd /src\ncargo build --release --target x86_64-fortanix-unknown-sgx\n")),(0,o.kt)("p",null,"After this step is complete, the binaries will be in\n",(0,o.kt)("inlineCode",{parentName:"p"},"/src/target/x86_64-fortanix-unknown-sgx/release/"),"."),(0,o.kt)("p",null,"To produce the sgxs format needed on the Oasis network, change directory\nto where a particular runtime's ",(0,o.kt)("inlineCode",{parentName:"p"},"Cargo.toml")," file is and run the\nfollowing command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cargo elf2sgxs --release\n")),(0,o.kt)("p",null,"It is necessary to change directories first because the tool does not\ncurrently support cargo workspaces."),(0,o.kt)("p",null,"The resulting binaries will have the ",(0,o.kt)("inlineCode",{parentName:"p"},".sgxs")," extension."))}m.isMDXComponent=!0}}]);