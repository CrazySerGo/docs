<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<title data-rh="true">Hello World | Oasis Network Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.oasis.dev/oasis-sdk/contract/hello-world"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-oasis-sdk-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-oasis-sdk-current"><meta data-rh="true" property="og:title" content="Hello World | Oasis Network Documentation"><meta data-rh="true" name="description" content="This section will show you how to quickly create, build and test a minimal"><meta data-rh="true" property="og:description" content="This section will show you how to quickly create, build and test a minimal"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.oasis.dev/oasis-sdk/contract/hello-world"><link data-rh="true" rel="alternate" href="https://docs.oasis.dev/oasis-sdk/contract/hello-world" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.oasis.dev/oasis-sdk/contract/hello-world" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.82805c98.css">
<link rel="preload" href="/assets/js/runtime~main.7be23080.js" as="script">
<link rel="preload" href="/assets/js/main.25c9afaa.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="OPF Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.png" alt="OPF Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Oasis Docs</b></a><a href="https://oasisprotocol.org/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://join.slack.com/t/oasiscommunity/shared_invite/enQtNjQ5MTA3NTgyOTkzLWIxNTg1ZWZmOTIwNmQ2MTg1YmU0MzgyMzk3OWM2ZWQ4NTQ0ZDJkNTBmMTdlM2JhODllYjg5YmJkODc2NzgwNTg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/oasisprotocol" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/oasis-sdk/">Introduction to Oasis SDK</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Smart Contracts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/oasis-sdk/contract/getting-started">Build a Smart Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/oasis-sdk/contract/hello-world">Hello World</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Runtimes</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/oasis-sdk/runtime/getting-started">Build a Runtime</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/oasis-sdk/runtime/minimal-runtime">Minimal Runtime</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/oasis-sdk/runtime/modules">Modules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/oasis-sdk/runtime/reproducibility">Reproducibility</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://api.docs.oasis.dev/oasis-sdk/oasis_runtime_sdk" target="_blank" rel="noopener noreferrer" class="menu__link" tabindex="0"><span>Runtime SDK<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://api.docs.oasis.dev/oasis-sdk/oasis_contract_sdk" target="_blank" rel="noopener noreferrer" class="menu__link" tabindex="0"><span>Contract SDK<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-sdk/client-sdk/go/client" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist" tabindex="0">Client SDK</a></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Hello World</h1><p>This section will show you how to quickly create, build and test a minimal
Oasis WebAssembly smart contract.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="repository-structure-and-dependencies">Repository Structure and Dependencies<a class="hash-link" href="#repository-structure-and-dependencies" title="Direct link to heading">​</a></h2><p>First we create the basic directory structure for the hello world contract using
Rust&#x27;s <a href="https://doc.rust-lang.org/cargo" target="_blank" rel="noopener noreferrer"><code>cargo</code></a>:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cargo init --lib hello-world</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will create the <code>hello-world</code> directory and populate it with some
boilerplate needed to describe a Rust application. It will also set up the
directory for version control using Git. The rest of the guide assumes that you
are executing commands from within this directory.</p><p>Since the Contract SDK requires a nightly version of the Rust toolchain, you
need to specify a version to use by creating a special file called
<code>rust-toolchain</code> containing the following information:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">nightly-2021-11-04</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>After you complete this guide, the minimal runtime directory structure will look
as follows:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">hello-world</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── Cargo.lock      # Rust dependency tree checksums.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── Cargo.toml      # Rust crate defintion.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── rust-toolchain  # Rust toolchain version configuration.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── lib.rs      # The smart contract definition.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="smart-contract-definition">Smart Contract Definition<a class="hash-link" href="#smart-contract-definition" title="Direct link to heading">​</a></h2><p>First you need to declare some dependencies in order to be able to use the smart
contract SDK. Additionally you will want to specify some optimization flags in
order to make the compiled smart contract as small as possible. To do this, edit
your <code>Cargo.toml</code> to look like the following:</p><div class="codeBlockContainer_I0IT language-toml theme-code-block"><div class="codeBlockContent_wNvx toml"><pre tabindex="0" class="prism-code language-toml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cargo-features = [&quot;strip&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[package]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name = &quot;hello-world&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version = &quot;0.0.0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">edition = &quot;2018&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">license = &quot;Apache-2.0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[lib]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crate-type = [&quot;cdylib&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[dependencies]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cbor = { version = &quot;0.2.1&quot;, package = &quot;oasis-cbor&quot; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oasis-contract-sdk = { git = &quot;https://github.com/oasisprotocol/oasis-sdk&quot; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oasis-contract-sdk-storage = { git = &quot;https://github.com/oasisprotocol/oasis-sdk&quot; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Third party.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thiserror = &quot;1.0.30&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[profile.release]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">opt-level = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rpath = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lto = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug-assertions = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">codegen-units = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">panic = &quot;abort&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">incremental = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">overflow-checks = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strip = true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>We are using Git tags for releases instead of releasing Rust packages on
crates.io.</p></div></div><p>After you have updated your <code>Cargo.toml</code> the next thing is to define the hello
world smart contract. To do this, edit <code>src/lib.rs</code> with the following
content:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">//! A minimal hello world smart contract.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extern crate alloc;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use oasis_contract_sdk as sdk;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use oasis_contract_sdk_storage::cell::Cell;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// All possible errors that can be returned by the contract.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// Each error is a triplet of (module, code, message) which allows it to be both easily</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// human readable and also identifyable programmatically.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[derive(Debug, thiserror::Error, sdk::Error)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub enum Error {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[error(&quot;bad request&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[sdk_error(code = 1)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BadRequest,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// All possible requests that the contract can handle.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// This includes both calls and queries.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[derive(Clone, Debug, cbor::Encode, cbor::Decode)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub enum Request {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[cbor(rename = &quot;instantiate&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Instantiate { initial_counter: u64 },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[cbor(rename = &quot;say_hello&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SayHello { who: String },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// All possible responses that the contract can return.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">///</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// This includes both calls and queries.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[derive(Clone, Debug, PartialEq, cbor::Encode, cbor::Decode)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub enum Response {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[cbor(rename = &quot;hello&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Hello { greeting: String },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[cbor(rename = &quot;empty&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Empty,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// The contract type.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub struct HelloWorld;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// Storage cell for the counter.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const COUNTER: Cell&lt;u64&gt; = Cell::new(b&quot;counter&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">impl HelloWorld {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// Increment the counter and return the previous value.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn increment_counter&lt;C: sdk::Context&gt;(ctx: &amp;mut C) -&gt; u64 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let counter = COUNTER.get(ctx.public_store()).unwrap_or_default();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        COUNTER.set(ctx.public_store(), counter + 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        counter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Implementation of the sdk::Contract trait is required in order for the type to be a contract.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">impl sdk::Contract for HelloWorld {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type Request = Request;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type Response = Response;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type Error = Error;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn instantiate&lt;C: sdk::Context&gt;(ctx: &amp;mut C, request: Request) -&gt; Result&lt;(), Error&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // This method is called during the contracts.Instantiate call when the contract is first</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // instantiated. It can be used to initialize the contract state.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        match request {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // We require the caller to always pass the Instantiate request.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Request::Instantiate { initial_counter } =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // Initialize counter to 1.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                COUNTER.set(ctx.public_store(), initial_counter);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Ok(())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _ =&gt; Err(Error::BadRequest),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn call&lt;C: sdk::Context&gt;(ctx: &amp;mut C, request: Request) -&gt; Result&lt;Response, Error&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // This method is called for each contracts.Call call. It is supposed to handle the request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // and return a response.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        match request {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Request::SayHello { who } =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // Increment the counter and retrieve the previous value.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                let counter = Self::increment_counter(ctx);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // Return the greeting as a response.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Ok(Response::Hello {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    greeting: format!(&quot;hello {} ({})&quot;, who, counter),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _ =&gt; Err(Error::BadRequest),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn query&lt;C: sdk::Context&gt;(_ctx: &amp;mut C, _request: Request) -&gt; Result&lt;Response, Error&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // This method is called for each contracts.Query query. It is supposed to handle the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // request and return a response.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Err(Error::BadRequest)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Create the required WASM exports required for the contract to be runnable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sdk::create_contract!(HelloWorld);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// We define some simple contract tests below.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[cfg(test)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mod test {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    use oasis_contract_sdk::{testing::MockContext, types::ExecutionContext, Contract};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    use super::*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn test_hello() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Create a mock execution context with default values.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let mut ctx: MockContext = ExecutionContext::default().into();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Instantiate the contract.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HelloWorld::instantiate(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &amp;mut ctx,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Request::Instantiate {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                initial_counter: 11,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .expect(&quot;instantiation should work&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Dispatch the SayHello message.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let rsp = HelloWorld::call(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &amp;mut ctx,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Request::SayHello {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                who: &quot;unit test&quot;.to_string(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .expect(&quot;SayHello call should work&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Make sure the greeting is correct.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert_eq!(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rsp,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Response::Hello {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                greeting: &quot;hello unit test (11)&quot;.to_string()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Dispatch another SayHello message.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let rsp = HelloWorld::call(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &amp;mut ctx,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Request::SayHello {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                who: &quot;second call&quot;.to_string(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .expect(&quot;SayHello call should work&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Make sure the greeting is correct.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert_eq!(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rsp,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Response::Hello {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                greeting: &quot;hello second call (12)&quot;.to_string()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This is it! You now have a simple hello world smart contract with included unit
tests for its functionality.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="building">Building<a class="hash-link" href="#building" title="Direct link to heading">​</a></h2><p>In order to build the smart contract before it can be uploaded to the target
chain, run:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cargo build --target wasm32-unknown-unknown --release</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will generate a binary file called <code>hello_world.wasm</code> under
<code>target/wasm32-unknown-unknown/release</code> which contains the smart contract
compiled into WebAssembly. This file can be directly deployed on chain.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="deploying-the-contract">Deploying the Contract<a class="hash-link" href="#deploying-the-contract" title="Direct link to heading">​</a></h2><p>Deploying the contract we just built is simple using the Oasis CLI. This section
assumes that you already have an instance of the CLI set up and that you will
be deploying contracts on the existing Testnet where you already have some
TEST tokens to cover transaction fees.</p><p>First, switch the default network to Cipher Testnet to avoid the need to pass
it to every following invocation.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">oasis network set-default testnet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oasis paratime set-default testnet cipher</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The first deployment step that needs to be performed only once for the given
binary is uploading the WASM binary.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">oasis contracts upload hello_world.wasm</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>After successful execution it will show the code ID that you need to use for any
subsequent instantiation of the same contract. Next, create an instance of the
contract by loading the code and calling its constructor with some dummy
arguments. Note that the arguments depend on the contract that is being deployed
and in our hello world case we are simply taking the initial counter value.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">oasis contracts instantiate CODEID --data &#x27;{&quot;instantiate&quot;: {&quot;initial_counter&quot;: 42}}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>After successful execution it shows the instance ID that you need for calling
the instantiated contract. Next, you can test calling the contract.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">oasis contracts call INSTANCEID --data &#x27;{&quot;say_hello&quot;: {&quot;who&quot;: &quot;me&quot;}}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_foO9"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-03-07T08:44:18.000Z">3/7/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/oasis-sdk/contract/getting-started"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Getting Started</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/oasis-sdk/runtime/getting-started"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Getting Started</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#repository-structure-and-dependencies" class="table-of-contents__link toc-highlight">Repository Structure and Dependencies</a></li><li><a href="#smart-contract-definition" class="table-of-contents__link toc-highlight">Smart Contract Definition</a></li><li><a href="#building" class="table-of-contents__link toc-highlight">Building</a></li><li><a href="#deploying-the-contract" class="table-of-contents__link toc-highlight">Deploying the Contract</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Oasis Protocol Foundation. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.7be23080.js"></script>
<script src="/assets/js/main.25c9afaa.js"></script>
</body>
</html>